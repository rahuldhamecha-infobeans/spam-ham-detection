<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.0.0-beta.3/js/bootstrap.js"></script>
<style>
.accordion {

    background-color: #fff;
    border-radius: 5px;

    background: rgba(0,0,255,0.2);
    color:white;

}
.css-vnbyu8 {
margin-top:-6%!important;
    display: inline-flex;
    -webkit-box-align: center;
    align-items: center;
    -webkit-box-pack: center;
    justify-content: center;
    box-sizing: border-box;
    -webkit-tap-highlight-color: transparent;
    outline: 0px;
    border: 0px;
    margin: 0px;
    cursor: pointer;
    user-select: none;
    vertical-align: middle;
    appearance: none;
    text-decoration: none;
    text-align: center;
    flex: 0 0 auto;
    font-size: 1.5rem;
    border-radius: 50%;
    overflow: visible;
    transition: background-color 150ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
    color: rgb(82, 79, 252);
    background-color: rgb(255, 255, 255);
    position: absolute;
    height: 40px;
    width: 40px;
    top: 77px;
    left: 20px;
    padding: 12px;
    box-shadow: rgba(33, 37, 41, 0.15) 1px 2px 7px;
}
.css-11pse9l {
    margin: 0px;
    font-family: Inter, sans-serif, "Helvetica Neue", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
    line-height: 1.5;
    color: inherit;
    font-size: 12px;
    font-weight: 400;
    letter-spacing: 1px;
    text-transform: uppercase;
}
.accordion .accordion-title {

    margin-bottom: 28px;
    text-align: center;
}

.accordion .content-container .question {

    padding: 20px 0px;
    font-size: 20px;
    cursor: pointer;
    border-bottom: 2px solid black;
    color:#000;
    position: relative;
}

.accordion .content-container .question::after {

    content: '+';
    position: absolute;
    right: -4px;
}

.accordion .content-container .answer {

    padding-top: 20px;
    line-height: 1.4;
    font-size: 20px;
    color:#000;
    height: 0px;
    overflow: hidden;
    transition: .5s;


}

.accordion .content-container.active .answer {

    height: 100px;
}

.accordion .content-container.active .question {

    font-size: 18px;
    transition: .5s;
}

.accordion .content-container.active .question::after {

    content: '-';
    font-size: 35px;
    transform: translateY(-20%);
    transition: .5s;

}
#wrapper {
  padding-right: 0;
  -webkit-transition: all 0.5s ease;
  -moz-transition: all 0.5s ease;
  -o-transition: all 0.5s ease;
  transition: all 0.5s ease;
}

#wrapper.toggled {
  padding-right: 250px;
}

#sidebar-wrapper {
  margin-top:-5%;
  z-index: 1000;
  position: fixed;
  right: 250px;
  width: 0;
  height: 100%;
  margin-right: -250px;
  overflow-y: auto;

  -webkit-transition: all 0.5s ease;
  -moz-transition: all 0.5s ease;
  -o-transition: all 0.5s ease;
  transition: all 0.5s ease;
  transition: box-shadow 300ms cubic-bezier(0.4, 0, 0.2, 1) 0ms;
    box-shadow: rgba(0, 0, 0, 0.2) 0px 2px 4px -1px, rgba(0, 0, 0, 0.14) 0px 4px 5px 0px, rgba(0, 0, 0, 0.12) 0px 1px 10px 0px;
}

#wrapper.toggled #sidebar-wrapper {
  width: 250px;
}

#page-content-wrapper {
  width: 100%;
  position: absolute;
  padding: 15px;
}

#wrapper.toggled #page-content-wrapper {
  position: absolute;
  margin-left: -250px;
}

/* Sidebar Styles */

.sidebar-nav {
  position: absolute;
  top: 0;
  width: 250px;
  margin: 0;
  padding: 0;
  list-style: none;
}

.sidebar-nav li {
  text-indent: 20px;
  line-height: 40px;
}

.sidebar-nav li a {
  display: block;
  text-decoration: none;
  color: #999999;
}

.sidebar-nav li a:hover {
  text-decoration: none;
  color: #fff;
  background: rgba(255, 255, 255, 0.2);
}

.sidebar-nav li a:active,
.sidebar-nav li a:focus {
  text-decoration: none;
}

.sidebar-nav > .sidebar-brand {
  height: 65px;
  font-size: 18px;
  line-height: 60px;
}

.sidebar-nav > .sidebar-brand a {
  color: #999999;
}

.sidebar-nav > .sidebar-brand a:hover {
  color: #fff;
  background: none;
}

@media (min-width: 768px) {
  #wrapper {
    padding-right: 0;
  }
  #wrapper.toggled {
    padding-right: 250px;
  }
  #sidebar-wrapper {
    width: 0;
  }
  #wrapper.toggled #sidebar-wrapper {
    width: 40%;
  }
  #page-content-wrapper {
    padding: 20px;
    position: relative;
  }
  #wrapper.toggled #page-content-wrapper {
    position: relative;
    margin-left: 0;
  }
}

* New styles to align the button to the right */
.title-container {
  display: flex;
  justify-content: space-between;
  align-items: center;
  padding: 10px;
  background: #333; /* You can adjust the background color */
  color: #fff; /* Text color */

}
.css-5277k6 {
    display: flex;
    flex-direction: row;
    -webkit-box-align: center;
    align-items: center;
    -webkit-box-pack: center;
    justify-content: center;
    padding-top: 16px;
    padding-bottom: 16px;
    background: linear-gradient(71.49deg, rgb(219, 243, 253) -9.87%, rgb(222, 221, 255) 79.01%);
    color: rgb(4, 3, 72);
}
.header{
 padding-top:80px;
}
.title-container h2 {
  margin: 0;
}

.btn-secondary {
  background: #007BFF; /* Button background color */
  color: #fff; /* Button text color */
  border: none;
  padding: 5px 10px;
  cursor: pointer;
  transition: background 0.3s;
}

.btn-secondary:hover {
  background: #0056b3; /* Button background color on hover */
}
.header {
  display: flex;
  justify-content: space-between;
  align-items: center;
}

.btn.btn-secondary {
  margin-left: 10px; /* Adjust the margin as needed for spacing */
}
.css-w0pj6f {
    overflow: hidden;
    pointer-events: none;
    position: absolute;
    z-index: 0;
    inset: 0px;
    border-radius: inherit;
}
</style>

{% extends 'layouts/admin/dashboard/base.html' %}
{% block page_title %} Smart Interview Assessment {% endblock %}
{% block page_body_title %}
  <!-- Create a container for the button and title -->
<div class="title-container">
  <div class="header">
    <h4>Report | Smart Interview Assessment</h4>
    <a href="#menu-toggle" class="added-css added-css1 btn btn-secondary float-right" id="menu-toggle"><i class="fa fa-arrow-circle-left icon fa-lg" aria-hidden="true"></i> Insights</a>
  </div>
  <div id="wrapper">

    <!-- Sidebar -->
    <div id="sidebar-wrapper">

      <button class="MuiButtonBase-root MuiIconButton-root MuiIconButton-sizeMedium css-vnbyu8" id="menu-toggle-out" tabindex="0" type="button" aria-label="Toggle Insights"><svg width="18" height="16" viewBox="0 0 18 16" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10 4L10 7L-3.93402e-07 7L-3.0598e-07 9L10 9L10 12L14 8L10 4ZM16 16L18 16L18 -7.86805e-07L16 -6.99382e-07L16 16Z" fill="currentColor"></path></svg><span class="MuiTouchRipple-root css-w0pj6f"></span></button>
      <script>

    $("#menu-toggle-out").click(function(e) {
      e.preventDefault();
      $("#wrapper").toggleClass("toggled");

      if ($("#wrapper").hasClass("toggled")) {
        $(".container").css("margin-left", "10px");
        $(".container").css("width", "60%");
        $(".added-css").css("margin-right", "39.6%");
         $(".added-css").css("transition", "margin-right 0.5s ease-in-out, transform 0.5s ease-in-out");
          $(".added-css1").css("display", "none");
        $(".icon").addClass("fa-arrow-circle-right");

        var element = document.querySelector('.added-css');

        if (element) {
  element.innerHTML = '<i class="fa fa-arrow-circle-right icon fa-lg" aria-hidden="true"></i> Outsights';
}
      } else {
        $(".container").css("margin-left", "");
        $(".added-css").css("margin-right", "");
        $(".container").css("width", "");
        $(".added-css1").css("display", "");
        $(".icon").removeClass("fa-arrow-circle-right");
        var element = document.querySelector('.added-css');
        if (element) {
  element.innerHTML = '<i class="fa fa-arrow-circle-left icon fa-lg" aria-hidden="true"></i> Insights';
}
      }
    });

    </script>
      <div class="accordion">
        <div class="css-5277k6"><p class="MuiTypography-root MuiTypography-body1 css-11pse9l">SANDEEP KUMAR GUPTA's Speaking Insights</p></div>


        <div class="content-container">
            <div class="question">How to pay?</div>
            <div class="answer">Lorem ipsum dolor sit amet consectetur adipisicing elit.
                Assumenda, neque provident nam odit ex,
                veritatis sit itaque quam ducimus suscipit illo

            </div>
        </div>


        <div class="content-container">
            <div class="question">How to complain?</div>
            <div class="answer">Lorem ipsum dolor sit amet consectetur adipisicing elit.
                Assumenda, neque provident nam odit ex,
                veritatis sit itaque quam ducimus suscipit illo

            </div>
        </div>


        <div class="content-container">
            <div class="question">How to refund?</div>
            <div class="answer">Lorem ipsum dolor sit amet consectetur adipisicing elit.
                Assumenda, neque provident nam odit ex,
                veritatis sit itaque quam ducimus suscipit illo
                error quis ratione vero debitis
            </div>
        </div>

      </div>
    <!-- /#sidebar-wrapper -->

  </div>
</div>


<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>
  $(document).ready(function() {
    $("#menu-toggle").click(function(e) {
      e.preventDefault();
      $("#wrapper").toggleClass("toggled");

      if ($("#wrapper").hasClass("toggled")) {
        $(".container").css("margin-left", "10px");
        $(".container").css("width", "60%");
        $(".added-css").css("margin-right", "39.6%");
        $(".added-css1").css("display", "none");
         $(".added-css").css("transition", "margin-right 0.5s ease-in-out, transform 0.5s ease-in-out");
        $(".icon").addClass("fa-arrow-circle-right");
        var element = document.querySelector('.added-css');
        if (element) {
  element.innerHTML = '<i class="fa fa-arrow-circle-right icon fa-lg" aria-hidden="true"></i> Outsights';
}
      } else {
        $(".container").css("margin-left", "");
        $(".added-css").css("margin-right", "");
        $(".container").css("width", "");
        $(".icon").removeClass("fa-arrow-circle-right");
        var element = document.querySelector('.added-css');
        $(".added-css1").css("display", "");
        if (element) {
  element.innerHTML = '<i class="fa fa-arrow-circle-left icon fa-lg" aria-hidden="true"></i> Insights';
}
      }
    });
  });

  const accordion = document.getElementsByClassName("content-container");

for (let i = 0; i < accordion.length; i++) {
  accordion[i].addEventListener("click", function () {
    this.classList.toggle("active");
    console.log(this);
  });
}

</script>
  </div>
{% endblock %}
{% block head_styles %}

<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
<link href="https://fonts.googleapis.com/css2?family=Lexend:wght@100;200;300;400;500;600;700;800;900&display=swap"
  rel="stylesheet" />
<link href="{{ url_for('static', filename='assets/css/details_report.css') }}" rel="stylesheet" />
<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.4/dist/jquery.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="{{ url_for('static', filename='admin/assets/js/single-report.js') }}"></script>

{% endblock %} {% block body_block %}
<div class="container">
  <div class="row mb-4">
    <div class="report_header">
      <h2 class="m-4 text-center">
        <u>Interview Report of {{ candidate.name }}</u>
      </h2>
      <!-- <a class="download_report" href="#"><button class="file-upload-button css-1ikvom0">
          <i class="fa fa-download"></i> Download Report
        </button></a> -->
    </div>
    <div class="col-md-6 stretch-card grid-margin">
      <div class="report-container">
        <h3 class="report-title">Interviewer's Score</h3>
        <i class="fa fa-info-circle icon-css" aria-hidden="true" title="Check Graph" data-bs-toggle="modal"
          data-bs-target="#graphmodal" data-video-report="{{candidate.overall_interviewer_video_report}}"
          data-text-report="{{candidate.overall_interviewer_text_report}}"
          data-audio-report="{{candidate.overall_interviewer_audio_report}}"></i>
      </div>
      <div class="card bg-gradient-success card-img-holder text-white">
        <i class="fa fa-info-circle icon-css" aria-hidden="true" title="Check Graph" data-bs-toggle="modal"
          data-bs-target="#confidenceLevel" style="position: absolute; top: 0; right: 0; margin: 10px;z-index:999"></i>
        <div class="card-body">

          <img src="{{ url_for('static', filename='assets/images/dashboard/circle.svg') }}" class="card-img-absolute"
            alt="circle-image" />

          <!-- Overall Interviewer Video Confidence -->
          {% set OIVC = overall.overall_interviewer_confidence['CL'] %}
          <!-- Overall Interviewer Text Confidence -->
          {% set OITC = overall.overall_interviewer_confidence_text['CL'] %}

          <p class="font-weight-normal mb-3 box-p-tag">
            Confidence Level (CL) - <small>{{ ((OIVC + OITC) / 2) | round(2) }}%</small>
            <i class="mdi mdi-diamond mdi-24px float-right"></i>
          </p>
          <p class="percentage-font">
            <span>Video Analysis:
              {{OIVC|round(2)}}%</span>
            <span>Text Analysis:
              {{OITC|round(2)}}%</span>
          </p>
        </div>
      </div>
    </div>
    <div class="col-md-6 stretch-card grid-margin">
      <div class="report-container">
        <h3 class="report-title">Candidate's Score</h3>
        <i class="fa fa-info-circle icon-css" aria-hidden="true" title="Check Graph" data-bs-toggle="modal"
          data-bs-target="#graphmodal" data-video-report="{{candidate.overall_candidate_video_report}}"
          data-text-report="{{candidate.overall_candidate_text_report}}"
          data-audio-report="{{candidate.overall_candidate_audio_report}}"></i>
      </div>
      <div class="card bg-gradient-success card-img-holder text-white">
        <div class="card-body">
          <img src="{{ url_for('static', filename='assets/images/dashboard/circle.svg') }}" class="card-img-absolute"
            alt="circle-image" />

          <!-- Overall Candidate Video Confidence -->
          {% set OCVC = overall.overall_candidate_confidence['CL'] %}
          <!-- Overall Candidate Text Confidence -->
          {% set OCTC = overall.overall_candidate_confidence_text['CL'] %}

          <p class="font-weight-normal mb-3 box-p-tag">
            Confidence Level (CL) - <small>{{ ((OCVC + OCTC) / 2) | round(2) }}%</small>
            <i class="mdi mdi-diamond mdi-24px float-right"></i>
          </p>
          <p class="percentage-font">
            <span>Video Analysis:
              {{OCVC|round(2)}}%</span>
            <span>Text Analysis:
              {{OCTC|round(2)}}%</span>
          </p>
        </div>
      </div>
    </div>

  </div>
  <div class="row">
    <div class="col-xl-12">
      <div class="card">
        <div class="card-header">
          <h4> Conversation Analysis</h4>
        </div>
        <div class="card-body">
          <div class="col-md mb-4 mb-md-0">
            <div class="accordion mt-3" id="question_answer_accordion">
              {% set list_length = report_data|length %}
              {% for video_report,
              video_process in report_data %}
              {% set index = loop.index %}
              {% if index <= list_length %} {% if index==list_length %} {% set
                next_video_process=report_data[index-1][1] %} {% else %} {% set next_video_process=report_data[index][1]
                %} {% endif %} {% if (next_video_process.start_duration|int - 3) <=video_process.end_duration|int
                <=(next_video_process.start_duration|int + 3) and video_process.speaker=='interviewer' %} <div
                class="card accordion-item">
                <h2 class="accordion-header" id="heading_{{ index }}">
                  <button type="button" class="accordion-button collapsed" data-bs-toggle="collapse"
                    data-bs-target="#accordion_{{ index }}" aria-expanded="false" aria-controls="accordion_{{ index }}">
                    <i class="fa fa-commenting" aria-hidden="true" style="color: #aa142d"></i>&nbsp;
                    {% if video_process.interview_transcript=='NA' %}
                        Transcript Not Found
                    {% else %}
                    {{video_process.interview_transcript }}
                    {% endif %}
                  </button>
                </h2>

                <div class="percentage-wrapper">
                  <div class="interviewer">
                    <i class="fa fa-info-circle icon-css" aria-hidden="true" title="Check Graph" data-bs-toggle="modal"
                      data-bs-target="#graphmodal" data-video-report="{{video_report.frame_dur_report}}"
                      data-text-report="{{video_report.text_dur_report}}"
                      data-audio-report="{{video_report.audio_report}}"></i>
                    <span>
                      Interviewer's Score(Video) = {{video_report.frame_dur_report|emotion_scores }}
                      <br />
                      Interviewer's Score(Text) = {{video_report.text_dur_report|emotion_scores }}

                    </span>

                  </div>
                  {% elif ((next_video_process.start_duration|int - 3) <= video_process.end_duration|int
                    <=((next_video_process.start_duration|int) + 3) and video_process.speaker=='candidate' and
                    video_process.start_duration !='0' ) %} <div class="candidate">
                    <i class="fa fa-info-circle icon-css" aria-hidden="true" title="Check Graph" data-bs-toggle="modal"
                      data-bs-target="#graphmodal" data-video-report="{{video_report.frame_dur_report}}"
                      data-text-report="{{video_report.text_dur_report}}"
                      data-audio-report="{{video_report.audio_report}}"></i>
                    <span>
                      Candidate's Score(Video) = {{video_report.frame_dur_report|emotion_scores }}
                      <br />
                      Candidate's Score(Text) = {{video_report.text_dur_report|emotion_scores }}
                    </span>

                </div>
            </div>

            <div id="accordion_{{ index - 1 }}" class="accordion-collapse collapse"
              data-bs-parent="#question_answer_accordion" aria-labelledby="heading_{{ index }}">
              <div class="accordion-body">
                <i class="fa fa-commenting" aria-hidden="true" style="color: #228b22"></i>&nbsp;
                  {% if video_process.interview_transcript=='NA' %}
                  Transcript Not Found
                {% else %}
                {{video_process.interview_transcript }}
                {% endif %}

              </div>
            </div>

            {% elif index == list_length and video_process.speaker ==
            'candidate' %}
            <div class="candidate">
              <i class="fa fa-info-circle icon-css" aria-hidden="true" title="Check Graph" data-bs-toggle="modal"
                data-bs-target="#graphmodal" data-video-report="{{video_report.frame_dur_report}}"
                data-text-report="{{video_report.text_dur_report}}"
                data-audio-report="{{video_report.audio_report}}"></i>
              <span>
                Candidate's Score(Video) = {{video_report.frame_dur_report|emotion_scores }}
                <br />
                Candidate's Score(Text) = {{video_report.text_dur_report|emotion_scores }}
              </span>

            </div>
          </div>
          <div id="accordion_{{ index - 1 }}" class="accordion-collapse collapse"
            data-bs-parent="#question_answer_accordion">
            <div class="accordion-body">
              <i class="fa fa-commenting" aria-hidden="true" style="color: #228b22"></i>&nbsp;
                {% if video_process.interview_transcript=='NA' %}
                  Transcript Not Found
                {% else %}
                {{video_process.interview_transcript }}
                {% endif %}
            </div>
          </div>
          {%elif video_process.speaker == 'interviewer'%}
          <div id="accordion_{{ index - 1 }}" class="accordion-collapse collapse"
            data-bs-parent="#question_answer_accordion">
            <div class="accordion-body">
              <i class="fa fa-commenting" aria-hidden="true" style="color: #228b22"></i>&nbsp;
              {% if video_process.interview_transcript=='NA' %}
              Transcript Not Found
            {% else %}
            {{video_process.interview_transcript }}
            {% endif %}
            </div>
          </div>

          {% endif %} {% if video_process.speaker == 'candidate' %}
        </div>
        {% endif %} {% endif %} {% endfor %}
      </div>
    </div>
  </div>
</div>
</div>
</div>

<!-- The Modal -->
<div class="modal" id="graphmodal">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body">
        <div class="chart-wrapper video_report_wrapper">
          <canvas id="video_report_canvas"></canvas>
          <div id="chart-text">Video Analysis</div>
        </div>
        <div class="chart-wrapper text_report_wrapper">
          <canvas id="text_report_canvas"></canvas>
          <div id="chart-text">Text Analysis</div>
        </div>
        <!-- <div class="chart-wrapper">
            <canvas id="audio_report_canvas"></canvas>
            <div id="chart-text">Center Text</div>
          </div> -->
      </div>
    </div>
  </div>
</div>

<!-- The Modal -->
<div class="modal" id="confidenceLevel">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body">
        <div>
          <h2>Logic Used to calculate Confidence Level</h2>
          <p>weight_neutral = 0.7, weight_happy = 0.2, weight_surprise = 0.05, weight_angry = 0.6, weight_fear = 0.7,
            weight_sad = 1, weight_disgust = 1</p>

          <p>We used the following to calculate weighted_sum</p>
          weighted_sum = (neutral * weight_neutral) + (happy * weight_happy) + (surprise * weight_surprise)</p>

          <p>
            The Confidence Level represents the cumulative emotional intensity of the selected emotions. It is equal to
            the weighted sum of the selected emotions' percentages.
          </p>
          <p><b>Formula for Confidence Level: confidence_level = weighted_sum</b></p>
        </div>

        <!-- <div class="chart-wrapper">
            <canvas id="audio_report_canvas"></canvas>
            <div id="chart-text">Center Text</div>
          </div> -->
      </div>
    </div>
  </div>
</div>


<div class="modal" id="nervousnessLevel">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
      </div>

      <div class="modal-body">
        <div>
          <h2>Logic Used to calculate Nervousness Level</h2>
          <p>weight_neutral = 0.7, weight_happy = 0.2, weight_surprise = 0.05, weight_angry = 0.6, weight_fear = 0.7,
            weight_sad = 1, weight_disgust = 1</p>

          <p>Formula for Sum of Remaining Emotions: other_emotions_sum = (angry * weight_angry) + (disgust *
            weight_disgust) + (fear * weight_fear) + (sad * weight_sad)</p>

          <p>The Nervousness Level represents the cumulative emotional intensity of the remaining emotions. It is equal
            to the sum of the remaining emotions' weighted percentages.
          </p>
          <p><b>Formula for Nervousness Level: nervousness_level = other_emotions_sum</b></p>
        </div>

        <!-- <div class="chart-wrapper">
            <canvas id="audio_report_canvas"></canvas>
            <div id="chart-text">Center Text</div>
          </div> -->
      </div>
    </div>
  </div>
</div>

{% endblock %}
